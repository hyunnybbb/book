
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>작업형 제 2 유형 예시문제 &#8212; DataManim</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "dean-kg/datamanim_comment");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">DataManim</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   DataManim
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../../content.html">
   파이썬으로 캐글 데이터 분석해보기
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../00_olympic/README.html">
     00_올림픽 데이터셋
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../00_olympic/status.html">
       개   요
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../01_ufc/README.html">
     01_ufc 기록 데이터셋
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../01_ufc/status.html">
       개   요
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../01_ufc/question.html">
       문  제  만
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="../02_mushroomClassification/README.html">
     02_버섯 분류 데이터셋
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="../02_mushroomClassification/status.html">
       개   요
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../02_mushroomClassification/question.html">
       문  제  만
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="README.html">
     03_빅분기예시문제
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="status.html">
       개   요
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="main_p1.html">
       작 업 형 1 유 형
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="main_p2.html">
       작 업 형 2 유 형
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/dataset/03_dataq/main_p2222.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/Datamanim/book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/Datamanim/book/issues/new?title=Issue%20on%20page%20%2Fdataset/03_dataq/main_p2222.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/Datamanim/book/gh-pages/?urlpath=tree/_sources/dataset/03_dataq/main_p2222.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/Datamanim/book/blob/gh-pages//_sources/dataset/03_dataq/main_p2222.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eda">
   데이터 전처리 및 EDA
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="id1">
<h1>작업형 제 2 유형 예시문제<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#matplotlib 패키지 한글 깨짐 처리 시작</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Darwin&#39;</span><span class="p">:</span> <span class="c1">#맥</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;AppleGothic&#39;</span><span class="p">)</span> 
<span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Windows&#39;</span><span class="p">:</span> <span class="c1">#윈도우</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Malgun Gothic&#39;</span><span class="p">)</span> 
<span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Linux&#39;</span><span class="p">:</span> <span class="c1">#리눅스 (구글 콜랩)</span>
        <span class="c1">#!wget &quot;https://www.wfonts.com/download/data/2016/06/13/malgun-gothic/malgun.ttf&quot;</span>
        <span class="c1">#!mv malgun.ttf /usr/share/fonts/truetype/</span>
        <span class="c1">#import matplotlib.font_manager as fm </span>
        <span class="c1">#fm._rebuild() </span>
        <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;Malgun Gothic&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#한글 폰트 사용시 마이너스 폰트 깨짐 해결</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># os.chdir -&gt; 데이터가 저장된 경로</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../../../../data/03_dataq/dataq&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;README.md&#39;, &#39;X_train.csv&#39;, &#39;mtcars.csv&#39;, &#39;.git&#39;, &#39;y_train.csv&#39;, &#39;X_test.csv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;y_train.csv&#39;</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;X_train.csv&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;euc-kr&#39;</span><span class="p">)</span>
<span class="n">X_test</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;X_test.csv&#39;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;euc-kr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="eda">
<h2>데이터 전처리 및 EDA<a class="headerlink" href="#eda" title="Permalink to this headline">¶</a></h2>
<div class="admonition-question-1 admonition">
<p class="admonition-title">Question 1</p>
<p><strong>y_train,X_train데이터를 합쳐 trainDf 변수에 저장하라</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>NaN</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-question-2 admonition">
<p class="admonition-title">Question 2</p>
<p><strong>trainDf와 X_test의 결측치가 있는 컬럼의 숫자 및 결측치 숫자를 파악하고 결측치처리 방식에 대해 생각해보자</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainNAN</span> <span class="o">=</span> <span class="n">trainDf</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainNAN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cust_id       0
gender        0
총구매액          0
최대구매액         0
환불금액       2295
주구매상품         0
주구매지점         0
내점일수          0
내점당구매건수       0
주말방문비율        0
구매주기          0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">testNAN</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">testNAN</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cust_id       0
총구매액          0
최대구매액         0
환불금액       1611
주구매상품         0
주구매지점         0
내점일수          0
내점당구매건수       0
주말방문비율        0
구매주기          0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isnullGender</span> <span class="o">=</span> <span class="n">trainDf</span><span class="p">[</span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;환불금액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">gender</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">isnullGender</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">isnullGender</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="s1">&#39;Women&#39;</span><span class="p">,</span><span class="s1">&#39;Men&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Missing Value of Gender&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_p2222_14_0.png" src="../../_images/main_p2222_14_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;환불금액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    1.205000e+03
mean     2.407822e+07
std      4.746453e+07
min      5.600000e+03
25%      2.259000e+06
50%      7.392000e+06
75%      2.412000e+07
max      5.637530e+08
Name: 환불금액, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>환블금액의 경우 최솟값이 0이 아니기에, Nan은 결측치가 아닌 환불을 하지않은 경우(0원)로 판단 할수 있다. nan은 0으로 채운다</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;환불금액&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;환불금액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition-question-3 admonition">
<p class="admonition-title">Question 3</p>
<p><strong>범주형 변수의 유일값과 유일값의 갯수를 파악하라</strong></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">main_index</span> <span class="o">=</span> <span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;주구매상품 유일값 수 &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">main_index</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;주구매상품 유일값 리스트 &#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">main_index</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>주구매상품 유일값 수  42
주구매상품 유일값 리스트  [&#39;기타&#39;, &#39;가공식품&#39;, &#39;농산물&#39;, &#39;화장품&#39;, &#39;시티웨어&#39;, &#39;디자이너&#39;, &#39;수산품&#39;, &#39;캐주얼&#39;, &#39;명품&#39;, &#39;섬유잡화&#39;, &#39;골프&#39;, &#39;스포츠&#39;, &#39;일용잡화&#39;, &#39;모피/피혁&#39;, &#39;육류&#39;, &#39;남성 캐주얼&#39;, &#39;구두&#39;, &#39;건강식품&#39;, &#39;차/커피&#39;, &#39;아동&#39;, &#39;피혁잡화&#39;, &#39;축산가공&#39;, &#39;주방용품&#39;, &#39;셔츠&#39;, &#39;젓갈/반찬&#39;, &#39;주방가전&#39;, &#39;트래디셔널&#39;, &#39;남성정장&#39;, &#39;생활잡화&#39;, &#39;주류&#39;, &#39;가구&#39;, &#39;커리어&#39;, &#39;란제리/내의&#39;, &#39;대형가전&#39;, &#39;식기&#39;, &#39;액세서리&#39;, &#39;침구/수예&#39;, &#39;보석&#39;, &#39;통신/컴퓨터&#39;, &#39;소형가전&#39;, &#39;악기&#39;, &#39;남성 트랜디&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">main_center</span> <span class="o">=</span> <span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;주구매지점 유일값 수 &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">main_center</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;주구매지점 유일값 리스트 &#39;</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="n">main_center</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>주구매지점 유일값 수  24
주구매지점 유일값 리스트  [&#39;본  점&#39;, &#39;잠실점&#39;, &#39;분당점&#39;, &#39;부산본점&#39;, &#39;영등포점&#39;, &#39;일산점&#39;, &#39;강남점&#39;, &#39;광주점&#39;, &#39;노원점&#39;, &#39;청량리점&#39;, &#39;대전점&#39;, &#39;미아점&#39;, &#39;부평점&#39;, &#39;동래점&#39;, &#39;관악점&#39;, &#39;인천점&#39;, &#39;안양점&#39;, &#39;포항점&#39;, &#39;대구점&#39;, &#39;울산점&#39;, &#39;센텀시티점&#39;, &#39;전주점&#39;, &#39;창원점&#39;, &#39;상인점&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>16077620</td>
      <td>4935000</td>
      <td>0.0</td>
      <td>기타</td>
      <td>광주점</td>
      <td>18</td>
      <td>2.444444</td>
      <td>0.318182</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>29050000</td>
      <td>24000000</td>
      <td>0.0</td>
      <td>보석</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3495</th>
      <td>3495</td>
      <td>1</td>
      <td>3175200</td>
      <td>3042900</td>
      <td>0.0</td>
      <td>골프</td>
      <td>본  점</td>
      <td>1</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3496</th>
      <td>3496</td>
      <td>1</td>
      <td>29628600</td>
      <td>7200000</td>
      <td>6049600.0</td>
      <td>시티웨어</td>
      <td>부산본점</td>
      <td>8</td>
      <td>1.625000</td>
      <td>0.461538</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3497</th>
      <td>3497</td>
      <td>0</td>
      <td>75000</td>
      <td>75000</td>
      <td>0.0</td>
      <td>주방용품</td>
      <td>창원점</td>
      <td>1</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3498</th>
      <td>3498</td>
      <td>0</td>
      <td>1875000</td>
      <td>1000000</td>
      <td>0.0</td>
      <td>화장품</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>39</td>
    </tr>
    <tr>
      <th>3499</th>
      <td>3499</td>
      <td>0</td>
      <td>263101550</td>
      <td>34632000</td>
      <td>5973000.0</td>
      <td>기타</td>
      <td>본  점</td>
      <td>38</td>
      <td>2.421053</td>
      <td>0.467391</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>3500 rows × 11 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">=</span> <span class="n">trainDf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>16077620</td>
      <td>4935000</td>
      <td>0.0</td>
      <td>18</td>
      <td>2.444444</td>
      <td>0.318182</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>29050000</td>
      <td>24000000</td>
      <td>0.0</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3495</th>
      <td>3495</td>
      <td>1</td>
      <td>3175200</td>
      <td>3042900</td>
      <td>0.0</td>
      <td>1</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3496</th>
      <td>3496</td>
      <td>1</td>
      <td>29628600</td>
      <td>7200000</td>
      <td>6049600.0</td>
      <td>8</td>
      <td>1.625000</td>
      <td>0.461538</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3497</th>
      <td>3497</td>
      <td>0</td>
      <td>75000</td>
      <td>75000</td>
      <td>0.0</td>
      <td>1</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3498</th>
      <td>3498</td>
      <td>0</td>
      <td>1875000</td>
      <td>1000000</td>
      <td>0.0</td>
      <td>2</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>39</td>
    </tr>
    <tr>
      <th>3499</th>
      <td>3499</td>
      <td>0</td>
      <td>263101550</td>
      <td>34632000</td>
      <td>5973000.0</td>
      <td>38</td>
      <td>2.421053</td>
      <td>0.467391</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>3500 rows × 9 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numeric</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;총구매액&#39;, &#39;최대구매액&#39;, &#39;환불금액&#39;, &#39;내점일수&#39;, &#39;내점당구매건수&#39;, &#39;주말방문비율&#39;, &#39;구매주기&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">numeric</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">t</span><span class="p">[[</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">]]</span>
    
    <span class="n">male</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">gender</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">female</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">gender</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">male</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;male&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">female</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;female&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">female</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">male</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">widths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;women&#39;</span><span class="p">,</span><span class="s1">&#39;men&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>총구매액
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_1.png" src="../../_images/main_p2222_31_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>최대구매액
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_3.png" src="../../_images/main_p2222_31_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>환불금액
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_5.png" src="../../_images/main_p2222_31_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>내점일수
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_7.png" src="../../_images/main_p2222_31_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>내점당구매건수
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_9.png" src="../../_images/main_p2222_31_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>주말방문비율
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_11.png" src="../../_images/main_p2222_31_11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>구매주기
</pre></div>
</div>
<img alt="../../_images/main_p2222_31_13.png" src="../../_images/main_p2222_31_13.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>16077620</td>
      <td>4935000</td>
      <td>0.0</td>
      <td>기타</td>
      <td>광주점</td>
      <td>18</td>
      <td>2.444444</td>
      <td>0.318182</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>29050000</td>
      <td>24000000</td>
      <td>0.0</td>
      <td>보석</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3495</th>
      <td>3495</td>
      <td>1</td>
      <td>3175200</td>
      <td>3042900</td>
      <td>0.0</td>
      <td>골프</td>
      <td>본  점</td>
      <td>1</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3496</th>
      <td>3496</td>
      <td>1</td>
      <td>29628600</td>
      <td>7200000</td>
      <td>6049600.0</td>
      <td>시티웨어</td>
      <td>부산본점</td>
      <td>8</td>
      <td>1.625000</td>
      <td>0.461538</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3497</th>
      <td>3497</td>
      <td>0</td>
      <td>75000</td>
      <td>75000</td>
      <td>0.0</td>
      <td>주방용품</td>
      <td>창원점</td>
      <td>1</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3498</th>
      <td>3498</td>
      <td>0</td>
      <td>1875000</td>
      <td>1000000</td>
      <td>0.0</td>
      <td>화장품</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>39</td>
    </tr>
    <tr>
      <th>3499</th>
      <td>3499</td>
      <td>0</td>
      <td>263101550</td>
      <td>34632000</td>
      <td>5973000.0</td>
      <td>기타</td>
      <td>본  점</td>
      <td>38</td>
      <td>2.421053</td>
      <td>0.467391</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>3500 rows × 11 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;count&#39;</span><span class="p">])[</span><span class="s1">&#39;총구매액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>주구매지점</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>센텀시티점</th>
      <td>1.098891e+07</td>
      <td>6</td>
    </tr>
    <tr>
      <th>전주점</th>
      <td>3.200927e+07</td>
      <td>5</td>
    </tr>
    <tr>
      <th>안양점</th>
      <td>6.055826e+07</td>
      <td>29</td>
    </tr>
    <tr>
      <th>청량리점</th>
      <td>6.346914e+07</td>
      <td>86</td>
    </tr>
    <tr>
      <th>강남점</th>
      <td>7.000790e+07</td>
      <td>145</td>
    </tr>
    <tr>
      <th>창원점</th>
      <td>7.043240e+07</td>
      <td>4</td>
    </tr>
    <tr>
      <th>미아점</th>
      <td>7.294025e+07</td>
      <td>69</td>
    </tr>
    <tr>
      <th>영등포점</th>
      <td>7.298017e+07</td>
      <td>241</td>
    </tr>
    <tr>
      <th>분당점</th>
      <td>7.318428e+07</td>
      <td>436</td>
    </tr>
    <tr>
      <th>울산점</th>
      <td>7.693346e+07</td>
      <td>6</td>
    </tr>
    <tr>
      <th>노원점</th>
      <td>7.734104e+07</td>
      <td>90</td>
    </tr>
    <tr>
      <th>부산본점</th>
      <td>8.207560e+07</td>
      <td>245</td>
    </tr>
    <tr>
      <th>잠실점</th>
      <td>8.377841e+07</td>
      <td>474</td>
    </tr>
    <tr>
      <th>관악점</th>
      <td>9.222403e+07</td>
      <td>46</td>
    </tr>
    <tr>
      <th>부평점</th>
      <td>9.268237e+07</td>
      <td>57</td>
    </tr>
    <tr>
      <th>대구점</th>
      <td>1.002752e+08</td>
      <td>7</td>
    </tr>
    <tr>
      <th>본  점</th>
      <td>1.023784e+08</td>
      <td>1077</td>
    </tr>
    <tr>
      <th>일산점</th>
      <td>1.082032e+08</td>
      <td>198</td>
    </tr>
    <tr>
      <th>동래점</th>
      <td>1.205072e+08</td>
      <td>49</td>
    </tr>
    <tr>
      <th>인천점</th>
      <td>1.226572e+08</td>
      <td>34</td>
    </tr>
    <tr>
      <th>포항점</th>
      <td>1.270351e+08</td>
      <td>11</td>
    </tr>
    <tr>
      <th>대전점</th>
      <td>1.528828e+08</td>
      <td>70</td>
    </tr>
    <tr>
      <th>광주점</th>
      <td>1.537850e+08</td>
      <td>114</td>
    </tr>
    <tr>
      <th>상인점</th>
      <td>4.539539e+08</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">주구매지점</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;강남점&#39;, &#39;잠실점&#39;, &#39;관악점&#39;, &#39;광주점&#39;, &#39;본  점&#39;, &#39;일산점&#39;, &#39;대전점&#39;, &#39;부산본점&#39;, &#39;분당점&#39;,
       &#39;영등포점&#39;, &#39;미아점&#39;, &#39;청량리점&#39;, &#39;안양점&#39;, &#39;부평점&#39;, &#39;동래점&#39;, &#39;포항점&#39;, &#39;노원점&#39;, &#39;창원점&#39;,
       &#39;센텀시티점&#39;, &#39;인천점&#39;, &#39;대구점&#39;, &#39;전주점&#39;, &#39;울산점&#39;, &#39;상인점&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>16077620</td>
      <td>4935000</td>
      <td>0.0</td>
      <td>기타</td>
      <td>광주점</td>
      <td>18</td>
      <td>2.444444</td>
      <td>0.318182</td>
      <td>16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>29050000</td>
      <td>24000000</td>
      <td>0.0</td>
      <td>보석</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3495</th>
      <td>3495</td>
      <td>1</td>
      <td>3175200</td>
      <td>3042900</td>
      <td>0.0</td>
      <td>골프</td>
      <td>본  점</td>
      <td>1</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3496</th>
      <td>3496</td>
      <td>1</td>
      <td>29628600</td>
      <td>7200000</td>
      <td>6049600.0</td>
      <td>시티웨어</td>
      <td>부산본점</td>
      <td>8</td>
      <td>1.625000</td>
      <td>0.461538</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3497</th>
      <td>3497</td>
      <td>0</td>
      <td>75000</td>
      <td>75000</td>
      <td>0.0</td>
      <td>주방용품</td>
      <td>창원점</td>
      <td>1</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3498</th>
      <td>3498</td>
      <td>0</td>
      <td>1875000</td>
      <td>1000000</td>
      <td>0.0</td>
      <td>화장품</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>39</td>
    </tr>
    <tr>
      <th>3499</th>
      <td>3499</td>
      <td>0</td>
      <td>263101550</td>
      <td>34632000</td>
      <td>5973000.0</td>
      <td>기타</td>
      <td>본  점</td>
      <td>38</td>
      <td>2.421053</td>
      <td>0.467391</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>3500 rows × 11 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pv_t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">,</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;cust_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pv_t</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주구매지점</th>
      <th>주구매상품</th>
      <th>cust_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남점</td>
      <td>가공식품</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강남점</td>
      <td>건강식품</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강남점</td>
      <td>구두</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강남점</td>
      <td>기타</td>
      <td>31</td>
    </tr>
    <tr>
      <th>4</th>
      <td>강남점</td>
      <td>남성 캐주얼</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>437</th>
      <td>포항점</td>
      <td>기타</td>
      <td>4</td>
    </tr>
    <tr>
      <th>438</th>
      <td>포항점</td>
      <td>모피/피혁</td>
      <td>1</td>
    </tr>
    <tr>
      <th>439</th>
      <td>포항점</td>
      <td>시티웨어</td>
      <td>2</td>
    </tr>
    <tr>
      <th>440</th>
      <td>포항점</td>
      <td>일용잡화</td>
      <td>1</td>
    </tr>
    <tr>
      <th>441</th>
      <td>포항점</td>
      <td>화장품</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>442 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pv_data</span> <span class="o">=</span><span class="n">pv_t</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;cust_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># pv_data = pv_data/pv_data.sum(axis=1)</span>

<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pv_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">pv_data</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">pv_data</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">/</span><span class="n">pv_data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span><span class="mi">100</span>

<span class="n">pv_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>주구매상품</th>
      <th>가공식품</th>
      <th>가구</th>
      <th>건강식품</th>
      <th>골프</th>
      <th>구두</th>
      <th>기타</th>
      <th>남성 캐주얼</th>
      <th>남성 트랜디</th>
      <th>남성정장</th>
      <th>농산물</th>
      <th>...</th>
      <th>주방용품</th>
      <th>차/커피</th>
      <th>축산가공</th>
      <th>침구/수예</th>
      <th>캐주얼</th>
      <th>커리어</th>
      <th>통신/컴퓨터</th>
      <th>트래디셔널</th>
      <th>피혁잡화</th>
      <th>화장품</th>
    </tr>
    <tr>
      <th>주구매지점</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강남점</th>
      <td>15.172414</td>
      <td>0.000000</td>
      <td>1.447467</td>
      <td>0.000000</td>
      <td>0.726639</td>
      <td>22.570648</td>
      <td>0.775692</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>13.209746</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.865519</td>
      <td>1.733055</td>
      <td>0.000000</td>
      <td>1.737074</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.870525</td>
      <td>0.871507</td>
      <td>7.852356</td>
    </tr>
    <tr>
      <th>관악점</th>
      <td>6.521739</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.038630</td>
      <td>23.273689</td>
      <td>4.774481</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>15.477830</td>
      <td>...</td>
      <td>1.350510</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.688295</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.995478</td>
    </tr>
    <tr>
      <th>광주점</th>
      <td>4.385965</td>
      <td>0.000000</td>
      <td>0.881943</td>
      <td>2.648588</td>
      <td>1.771220</td>
      <td>27.509653</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.073503</td>
      <td>...</td>
      <td>0.949979</td>
      <td>0.000000</td>
      <td>1.900861</td>
      <td>0.000000</td>
      <td>5.707962</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.769887</td>
    </tr>
    <tr>
      <th>노원점</th>
      <td>21.111111</td>
      <td>1.085645</td>
      <td>1.084637</td>
      <td>0.000000</td>
      <td>3.250926</td>
      <td>27.017587</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.057643</td>
      <td>12.683977</td>
      <td>...</td>
      <td>1.039607</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.117538</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.037911</td>
      <td>3.112510</td>
    </tr>
    <tr>
      <th>대구점</th>
      <td>28.571429</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.957447</td>
      <td>...</td>
      <td>0.000000</td>
      <td>2.551444</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.454293</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>대전점</th>
      <td>20.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.894737</td>
      <td>2.567568</td>
      <td>14.019471</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.227268</td>
      <td>4.895419</td>
      <td>...</td>
      <td>1.157848</td>
      <td>0.000000</td>
      <td>1.155736</td>
      <td>0.000000</td>
      <td>3.460977</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.147556</td>
      <td>6.873698</td>
    </tr>
    <tr>
      <th>동래점</th>
      <td>12.244898</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.810122</td>
      <td>3.567923</td>
      <td>6.941679</td>
      <td>1.651129</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9.801399</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.755233</td>
      <td>1.319750</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.314204</td>
      <td>2.617600</td>
    </tr>
    <tr>
      <th>미아점</th>
      <td>8.695652</td>
      <td>1.394785</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.774293</td>
      <td>34.310153</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9.735335</td>
      <td>...</td>
      <td>1.144846</td>
      <td>1.142951</td>
      <td>1.141087</td>
      <td>0.000000</td>
      <td>2.278505</td>
      <td>1.135649</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.133903</td>
    </tr>
    <tr>
      <th>본  점</th>
      <td>19.498607</td>
      <td>0.338410</td>
      <td>2.149718</td>
      <td>3.460261</td>
      <td>1.546796</td>
      <td>16.887943</td>
      <td>2.408335</td>
      <td>0.144657</td>
      <td>0.869018</td>
      <td>11.381814</td>
      <td>...</td>
      <td>5.202847</td>
      <td>7.302816</td>
      <td>1.670845</td>
      <td>1.013785</td>
      <td>7.144450</td>
      <td>1.071127</td>
      <td>0.000000</td>
      <td>2.876146</td>
      <td>5.493979</td>
      <td>35.670896</td>
    </tr>
    <tr>
      <th>부산본점</th>
      <td>11.428571</td>
      <td>0.000000</td>
      <td>2.188868</td>
      <td>5.318738</td>
      <td>2.740525</td>
      <td>8.345825</td>
      <td>2.426919</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>11.796542</td>
      <td>...</td>
      <td>0.659552</td>
      <td>0.000000</td>
      <td>2.644144</td>
      <td>0.000000</td>
      <td>5.336113</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.716322</td>
      <td>23.976826</td>
    </tr>
    <tr>
      <th>부평점</th>
      <td>19.298246</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.531435</td>
      <td>0.000000</td>
      <td>21.267003</td>
      <td>1.368051</td>
      <td>0.000000</td>
      <td>1.361197</td>
      <td>13.545376</td>
      <td>...</td>
      <td>0.000000</td>
      <td>1.229379</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.225922</td>
      <td>1.222536</td>
      <td>1.219219</td>
    </tr>
    <tr>
      <th>분당점</th>
      <td>10.779817</td>
      <td>0.500275</td>
      <td>1.004318</td>
      <td>1.264912</td>
      <td>0.510791</td>
      <td>27.944411</td>
      <td>2.912579</td>
      <td>0.330123</td>
      <td>0.661710</td>
      <td>26.586116</td>
      <td>...</td>
      <td>0.552354</td>
      <td>1.107445</td>
      <td>5.564729</td>
      <td>0.570555</td>
      <td>2.859781</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.158089</td>
      <td>17.456432</td>
    </tr>
    <tr>
      <th>상인점</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>센텀시티점</th>
      <td>16.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.615385</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910751</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.411736</td>
    </tr>
    <tr>
      <th>안양점</th>
      <td>13.793103</td>
      <td>0.000000</td>
      <td>2.577778</td>
      <td>2.477033</td>
      <td>0.000000</td>
      <td>14.337632</td>
      <td>3.985211</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.750348</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.637787</td>
      <td>0.000000</td>
      <td>1.620856</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.209415</td>
    </tr>
    <tr>
      <th>영등포점</th>
      <td>7.883817</td>
      <td>0.435002</td>
      <td>1.744296</td>
      <td>2.642437</td>
      <td>2.235081</td>
      <td>9.957426</td>
      <td>4.308321</td>
      <td>0.000000</td>
      <td>1.469102</td>
      <td>6.414195</td>
      <td>...</td>
      <td>0.682908</td>
      <td>2.737559</td>
      <td>2.071064</td>
      <td>0.000000</td>
      <td>7.642914</td>
      <td>0.000000</td>
      <td>0.711404</td>
      <td>0.712868</td>
      <td>3.571649</td>
      <td>10.103707</td>
    </tr>
    <tr>
      <th>울산점</th>
      <td>16.666667</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.615385</td>
      <td>0.000000</td>
      <td>3.955375</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.248987</td>
      <td>0.000000</td>
      <td>3.027751</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>인천점</th>
      <td>17.647059</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>10.953608</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.937959</td>
      <td>7.613446</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.525031</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>일산점</th>
      <td>17.171717</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.103925</td>
      <td>0.000000</td>
      <td>26.625893</td>
      <td>0.629321</td>
      <td>0.000000</td>
      <td>0.630792</td>
      <td>8.219439</td>
      <td>...</td>
      <td>1.477074</td>
      <td>5.189803</td>
      <td>3.757430</td>
      <td>0.000000</td>
      <td>6.827123</td>
      <td>0.771282</td>
      <td>0.000000</td>
      <td>3.090580</td>
      <td>1.556225</td>
      <td>8.588896</td>
    </tr>
    <tr>
      <th>잠실점</th>
      <td>19.409283</td>
      <td>0.498245</td>
      <td>1.500347</td>
      <td>3.287744</td>
      <td>3.111262</td>
      <td>19.373319</td>
      <td>0.928275</td>
      <td>0.000000</td>
      <td>0.934264</td>
      <td>9.089691</td>
      <td>...</td>
      <td>1.955900</td>
      <td>1.975647</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.980198</td>
      <td>1.567224</td>
      <td>0.526348</td>
      <td>3.693643</td>
      <td>2.685163</td>
      <td>22.839295</td>
    </tr>
    <tr>
      <th>전주점</th>
      <td>40.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.325581</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.256034</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>창원점</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>25.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>3.044839</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>청량리점</th>
      <td>13.953488</td>
      <td>0.000000</td>
      <td>4.547858</td>
      <td>1.129926</td>
      <td>2.256540</td>
      <td>15.750191</td>
      <td>2.206580</td>
      <td>0.000000</td>
      <td>2.201562</td>
      <td>14.278474</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.059195</td>
      <td>0.000000</td>
      <td>1.058531</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.115751</td>
      <td>3.169745</td>
    </tr>
    <tr>
      <th>포항점</th>
      <td>18.181818</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.715719</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.275697</td>
    </tr>
  </tbody>
</table>
<p>24 rows × 42 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pv_data</span><span class="o">=</span> <span class="n">pv_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">pv_data</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span><span class="s1">&#39;상인점&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;지점별 품목 카테고리 구매 건수&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">pv_data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pv_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">pv_data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pv_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">pv_data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_p2222_40_0.png" src="../../_images/main_p2222_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center_gender</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;cust_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;cust_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center_gender</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="n">center_gender</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="n">center_gender</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">center_gender</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="n">center_gender</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="n">center_gender</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mm</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">center_gender</span><span class="p">),</span><span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7faac3810c40&gt;
</pre></div>
</div>
<img alt="../../_images/main_p2222_46_1.png" src="../../_images/main_p2222_46_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">center_gender</span><span class="o">.</span><span class="n">ratio</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_p2222_47_0.png" src="../../_images/main_p2222_47_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pv_data</span><span class="p">[</span><span class="s1">&#39;ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">center_gender</span><span class="o">.</span><span class="n">ratio</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pv_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>주구매상품</th>
      <th>가공식품</th>
      <th>가구</th>
      <th>건강식품</th>
      <th>골프</th>
      <th>구두</th>
      <th>기타</th>
      <th>남성 캐주얼</th>
      <th>남성 트랜디</th>
      <th>남성정장</th>
      <th>농산물</th>
      <th>...</th>
      <th>차/커피</th>
      <th>축산가공</th>
      <th>침구/수예</th>
      <th>캐주얼</th>
      <th>커리어</th>
      <th>통신/컴퓨터</th>
      <th>트래디셔널</th>
      <th>피혁잡화</th>
      <th>화장품</th>
      <th>ratio</th>
    </tr>
    <tr>
      <th>주구매지점</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강남점</th>
      <td>22.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>31.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>25.517241</td>
    </tr>
    <tr>
      <th>관악점</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>12.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>41.304348</td>
    </tr>
    <tr>
      <th>광주점</th>
      <td>5.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>31.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>40.350877</td>
    </tr>
    <tr>
      <th>노원점</th>
      <td>19.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>12.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>31.111111</td>
    </tr>
    <tr>
      <th>대구점</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>71.428571</td>
    </tr>
    <tr>
      <th>대전점</th>
      <td>14.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>35.714286</td>
    </tr>
    <tr>
      <th>동래점</th>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>34.693878</td>
    </tr>
    <tr>
      <th>미아점</th>
      <td>6.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>25.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>43.478261</td>
    </tr>
    <tr>
      <th>본  점</th>
      <td>210.0</td>
      <td>3.0</td>
      <td>19.0</td>
      <td>30.0</td>
      <td>13.0</td>
      <td>140.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>78.0</td>
      <td>...</td>
      <td>23.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>21.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>15.0</td>
      <td>94.0</td>
      <td>40.297122</td>
    </tr>
    <tr>
      <th>부산본점</th>
      <td>28.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>12.0</td>
      <td>6.0</td>
      <td>18.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>24.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>35.0</td>
      <td>33.469388</td>
    </tr>
    <tr>
      <th>부평점</th>
      <td>11.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>29.824561</td>
    </tr>
    <tr>
      <th>분당점</th>
      <td>47.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>109.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>80.0</td>
      <td>...</td>
      <td>2.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>30.0</td>
      <td>35.321101</td>
    </tr>
    <tr>
      <th>상인점</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>센텀시티점</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>50.000000</td>
    </tr>
    <tr>
      <th>안양점</th>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>51.724138</td>
    </tr>
    <tr>
      <th>영등포점</th>
      <td>19.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>22.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>14.0</td>
      <td>41.078838</td>
    </tr>
    <tr>
      <th>울산점</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>50.000000</td>
    </tr>
    <tr>
      <th>인천점</th>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>47.058824</td>
    </tr>
    <tr>
      <th>일산점</th>
      <td>34.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>48.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>11.0</td>
      <td>35.353535</td>
    </tr>
    <tr>
      <th>잠실점</th>
      <td>92.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>13.0</td>
      <td>12.0</td>
      <td>73.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>29.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>42.0</td>
      <td>35.654008</td>
    </tr>
    <tr>
      <th>전주점</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>100.000000</td>
    </tr>
    <tr>
      <th>창원점</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.000000</td>
    </tr>
    <tr>
      <th>청량리점</th>
      <td>12.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>43.023256</td>
    </tr>
    <tr>
      <th>포항점</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>36.363636</td>
    </tr>
  </tbody>
</table>
<p>24 rows × 43 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>본  점     1077
잠실점       474
분당점       436
부산본점      245
영등포점      241
일산점       198
강남점       145
광주점       114
노원점        90
청량리점       86
대전점        70
미아점        69
부평점        57
동래점        49
관악점        46
인천점        34
안양점        29
포항점        11
대구점         7
울산점         6
센텀시티점       6
전주점         5
창원점         4
상인점         1
Name: 주구매지점, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_test</span><span class="p">[</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>본  점     726
잠실점      352
분당점      328
부산본점     168
일산점      158
영등포점     150
강남점      101
광주점       86
청량리점      78
노원점       53
미아점       52
부평점       50
대전점       41
동래점       36
관악점       30
안양점       27
인천점       22
울산점        5
포항점        5
창원점        4
상인점        3
센텀시티점      3
전주점        2
대구점        2
Name: 주구매지점, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;총구매액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;총구매액&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>총구매액</th>
    </tr>
    <tr>
      <th>주구매지점</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>센텀시티점</th>
      <td>1.098891e+07</td>
    </tr>
    <tr>
      <th>전주점</th>
      <td>3.200927e+07</td>
    </tr>
    <tr>
      <th>안양점</th>
      <td>6.055826e+07</td>
    </tr>
    <tr>
      <th>청량리점</th>
      <td>6.346914e+07</td>
    </tr>
    <tr>
      <th>강남점</th>
      <td>7.000790e+07</td>
    </tr>
    <tr>
      <th>창원점</th>
      <td>7.043240e+07</td>
    </tr>
    <tr>
      <th>미아점</th>
      <td>7.294025e+07</td>
    </tr>
    <tr>
      <th>영등포점</th>
      <td>7.298017e+07</td>
    </tr>
    <tr>
      <th>분당점</th>
      <td>7.318428e+07</td>
    </tr>
    <tr>
      <th>울산점</th>
      <td>7.693346e+07</td>
    </tr>
    <tr>
      <th>노원점</th>
      <td>7.734104e+07</td>
    </tr>
    <tr>
      <th>부산본점</th>
      <td>8.207560e+07</td>
    </tr>
    <tr>
      <th>잠실점</th>
      <td>8.377841e+07</td>
    </tr>
    <tr>
      <th>관악점</th>
      <td>9.222403e+07</td>
    </tr>
    <tr>
      <th>부평점</th>
      <td>9.268237e+07</td>
    </tr>
    <tr>
      <th>대구점</th>
      <td>1.002752e+08</td>
    </tr>
    <tr>
      <th>본  점</th>
      <td>1.023784e+08</td>
    </tr>
    <tr>
      <th>일산점</th>
      <td>1.082032e+08</td>
    </tr>
    <tr>
      <th>동래점</th>
      <td>1.205072e+08</td>
    </tr>
    <tr>
      <th>인천점</th>
      <td>1.226572e+08</td>
    </tr>
    <tr>
      <th>포항점</th>
      <td>1.270351e+08</td>
    </tr>
    <tr>
      <th>대전점</th>
      <td>1.528828e+08</td>
    </tr>
    <tr>
      <th>광주점</th>
      <td>1.537850e+08</td>
    </tr>
    <tr>
      <th>상인점</th>
      <td>4.539539e+08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;최대구매액&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">706629000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1626</th>
      <td>1626</td>
      <td>0</td>
      <td>1715219490</td>
      <td>706629000</td>
      <td>11423000.0</td>
      <td>가공식품</td>
      <td>본  점</td>
      <td>162</td>
      <td>2.425926</td>
      <td>0.371501</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;최대구매액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>706629000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
    </tr>
    <tr>
      <th>주구매상품</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>가공식품</th>
      <td>1699.443223</td>
      <td>0.419414</td>
      <td>7.573852e+07</td>
      <td>1.938905e+07</td>
      <td>6.452250e+06</td>
      <td>21.749084</td>
      <td>3.583988</td>
      <td>0.316577</td>
      <td>22.946886</td>
    </tr>
    <tr>
      <th>가구</th>
      <td>1081.500000</td>
      <td>0.500000</td>
      <td>3.008169e+07</td>
      <td>2.549360e+07</td>
      <td>1.011060e+06</td>
      <td>2.500000</td>
      <td>1.170000</td>
      <td>0.433333</td>
      <td>8.100000</td>
    </tr>
    <tr>
      <th>건강식품</th>
      <td>1964.297872</td>
      <td>0.531915</td>
      <td>3.997081e+07</td>
      <td>1.150436e+07</td>
      <td>8.153681e+05</td>
      <td>5.680851</td>
      <td>1.439388</td>
      <td>0.380636</td>
      <td>28.617021</td>
    </tr>
    <tr>
      <th>골프</th>
      <td>1750.378049</td>
      <td>0.536585</td>
      <td>1.421196e+08</td>
      <td>2.470139e+07</td>
      <td>9.161422e+06</td>
      <td>15.853659</td>
      <td>2.098424</td>
      <td>0.398663</td>
      <td>18.597561</td>
    </tr>
    <tr>
      <th>구두</th>
      <td>1916.500000</td>
      <td>0.518519</td>
      <td>3.136176e+07</td>
      <td>7.427265e+06</td>
      <td>4.919648e+05</td>
      <td>4.518519</td>
      <td>1.834178</td>
      <td>0.327587</td>
      <td>27.592593</td>
    </tr>
    <tr>
      <th>기타</th>
      <td>1780.317647</td>
      <td>0.369748</td>
      <td>1.214631e+08</td>
      <td>2.374643e+07</td>
      <td>8.439859e+06</td>
      <td>28.297479</td>
      <td>3.799842</td>
      <td>0.316960</td>
      <td>18.678992</td>
    </tr>
    <tr>
      <th>남성 캐주얼</th>
      <td>1736.872727</td>
      <td>0.763636</td>
      <td>4.589379e+07</td>
      <td>1.855488e+07</td>
      <td>9.382782e+05</td>
      <td>5.181818</td>
      <td>1.701575</td>
      <td>0.267895</td>
      <td>24.818182</td>
    </tr>
    <tr>
      <th>남성 트랜디</th>
      <td>1675.000000</td>
      <td>0.500000</td>
      <td>2.554195e+08</td>
      <td>3.038360e+07</td>
      <td>1.256190e+07</td>
      <td>34.500000</td>
      <td>1.617647</td>
      <td>0.753289</td>
      <td>2.500000</td>
    </tr>
    <tr>
      <th>남성정장</th>
      <td>2010.590909</td>
      <td>0.818182</td>
      <td>1.897295e+07</td>
      <td>1.316409e+07</td>
      <td>2.048636e+05</td>
      <td>2.363636</td>
      <td>1.446970</td>
      <td>0.366180</td>
      <td>28.772727</td>
    </tr>
    <tr>
      <th>농산물</th>
      <td>1671.828909</td>
      <td>0.271386</td>
      <td>1.182750e+08</td>
      <td>2.195026e+07</td>
      <td>9.280305e+06</td>
      <td>38.064897</td>
      <td>4.359979</td>
      <td>0.279182</td>
      <td>15.731563</td>
    </tr>
    <tr>
      <th>대형가전</th>
      <td>1853.500000</td>
      <td>0.500000</td>
      <td>9.750236e+07</td>
      <td>7.017750e+07</td>
      <td>3.649825e+07</td>
      <td>7.750000</td>
      <td>1.221392</td>
      <td>0.309778</td>
      <td>9.250000</td>
    </tr>
    <tr>
      <th>디자이너</th>
      <td>1862.943005</td>
      <td>0.129534</td>
      <td>2.274291e+08</td>
      <td>4.284242e+07</td>
      <td>4.200441e+07</td>
      <td>26.373057</td>
      <td>1.875470</td>
      <td>0.233541</td>
      <td>16.129534</td>
    </tr>
    <tr>
      <th>란제리/내의</th>
      <td>1871.125000</td>
      <td>0.250000</td>
      <td>3.179583e+07</td>
      <td>7.009250e+06</td>
      <td>2.801200e+06</td>
      <td>5.625000</td>
      <td>2.056548</td>
      <td>0.152934</td>
      <td>24.000000</td>
    </tr>
    <tr>
      <th>명품</th>
      <td>1731.230000</td>
      <td>0.390000</td>
      <td>2.062967e+08</td>
      <td>3.119606e+07</td>
      <td>2.257598e+07</td>
      <td>30.450000</td>
      <td>2.010490</td>
      <td>0.317688</td>
      <td>16.810000</td>
    </tr>
    <tr>
      <th>모피/피혁</th>
      <td>1834.228070</td>
      <td>0.315789</td>
      <td>2.004860e+07</td>
      <td>1.020943e+07</td>
      <td>1.552754e+06</td>
      <td>4.438596</td>
      <td>2.169857</td>
      <td>0.275215</td>
      <td>27.298246</td>
    </tr>
    <tr>
      <th>보석</th>
      <td>934.333333</td>
      <td>0.333333</td>
      <td>6.191560e+07</td>
      <td>2.875760e+07</td>
      <td>0.000000e+00</td>
      <td>2.666667</td>
      <td>1.433333</td>
      <td>0.259259</td>
      <td>31.333333</td>
    </tr>
    <tr>
      <th>생활잡화</th>
      <td>1505.333333</td>
      <td>0.466667</td>
      <td>2.651373e+07</td>
      <td>1.665607e+07</td>
      <td>1.305600e+06</td>
      <td>3.400000</td>
      <td>1.871699</td>
      <td>0.285317</td>
      <td>24.400000</td>
    </tr>
    <tr>
      <th>섬유잡화</th>
      <td>1807.642857</td>
      <td>0.510204</td>
      <td>2.252077e+07</td>
      <td>8.248898e+06</td>
      <td>1.102159e+06</td>
      <td>5.826531</td>
      <td>1.941338</td>
      <td>0.350300</td>
      <td>23.265306</td>
    </tr>
    <tr>
      <th>셔츠</th>
      <td>1864.433333</td>
      <td>0.633333</td>
      <td>1.938991e+07</td>
      <td>9.210910e+06</td>
      <td>6.606933e+05</td>
      <td>4.833333</td>
      <td>1.749337</td>
      <td>0.393578</td>
      <td>13.100000</td>
    </tr>
    <tr>
      <th>소형가전</th>
      <td>1778.000000</td>
      <td>0.500000</td>
      <td>2.190000e+05</td>
      <td>2.190000e+05</td>
      <td>0.000000e+00</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>수산품</th>
      <td>1693.032680</td>
      <td>0.398693</td>
      <td>3.367786e+07</td>
      <td>1.051821e+07</td>
      <td>1.439369e+06</td>
      <td>10.000000</td>
      <td>2.849504</td>
      <td>0.275082</td>
      <td>25.790850</td>
    </tr>
    <tr>
      <th>스포츠</th>
      <td>1462.028986</td>
      <td>0.521739</td>
      <td>5.569067e+07</td>
      <td>1.420613e+07</td>
      <td>3.705570e+06</td>
      <td>10.666667</td>
      <td>2.030339</td>
      <td>0.251267</td>
      <td>18.855072</td>
    </tr>
    <tr>
      <th>시티웨어</th>
      <td>1748.450704</td>
      <td>0.206573</td>
      <td>8.068945e+07</td>
      <td>1.879223e+07</td>
      <td>7.315927e+06</td>
      <td>12.901408</td>
      <td>1.973345</td>
      <td>0.278706</td>
      <td>22.145540</td>
    </tr>
    <tr>
      <th>식기</th>
      <td>2323.571429</td>
      <td>0.714286</td>
      <td>3.989952e+07</td>
      <td>1.151089e+07</td>
      <td>6.078571e+06</td>
      <td>7.428571</td>
      <td>1.937347</td>
      <td>0.175119</td>
      <td>16.857143</td>
    </tr>
    <tr>
      <th>아동</th>
      <td>1499.600000</td>
      <td>0.350000</td>
      <td>1.644723e+08</td>
      <td>2.768842e+07</td>
      <td>1.208683e+07</td>
      <td>21.325000</td>
      <td>2.450852</td>
      <td>0.467078</td>
      <td>21.375000</td>
    </tr>
    <tr>
      <th>악기</th>
      <td>3218.500000</td>
      <td>1.000000</td>
      <td>3.374000e+06</td>
      <td>2.518000e+06</td>
      <td>0.000000e+00</td>
      <td>2.000000</td>
      <td>1.250000</td>
      <td>0.583333</td>
      <td>46.500000</td>
    </tr>
    <tr>
      <th>액세서리</th>
      <td>1558.600000</td>
      <td>0.200000</td>
      <td>3.666200e+06</td>
      <td>3.992400e+06</td>
      <td>1.377600e+06</td>
      <td>1.600000</td>
      <td>1.400000</td>
      <td>0.460000</td>
      <td>21.400000</td>
    </tr>
    <tr>
      <th>육류</th>
      <td>2027.701754</td>
      <td>0.456140</td>
      <td>2.371774e+07</td>
      <td>7.974206e+06</td>
      <td>1.836377e+06</td>
      <td>8.245614</td>
      <td>2.311867</td>
      <td>0.333373</td>
      <td>23.333333</td>
    </tr>
    <tr>
      <th>일용잡화</th>
      <td>1834.578125</td>
      <td>0.328125</td>
      <td>2.975380e+07</td>
      <td>8.736970e+06</td>
      <td>1.958361e+06</td>
      <td>8.906250</td>
      <td>2.397870</td>
      <td>0.314487</td>
      <td>26.140625</td>
    </tr>
    <tr>
      <th>젓갈/반찬</th>
      <td>1942.517241</td>
      <td>0.517241</td>
      <td>1.665637e+07</td>
      <td>5.730610e+06</td>
      <td>2.028617e+06</td>
      <td>7.482759</td>
      <td>2.908319</td>
      <td>0.254183</td>
      <td>35.551724</td>
    </tr>
    <tr>
      <th>주류</th>
      <td>1881.428571</td>
      <td>0.785714</td>
      <td>3.007618e+07</td>
      <td>9.383350e+06</td>
      <td>4.000000e+02</td>
      <td>5.571429</td>
      <td>2.903061</td>
      <td>0.349607</td>
      <td>30.571429</td>
    </tr>
    <tr>
      <th>주방가전</th>
      <td>1556.038462</td>
      <td>0.692308</td>
      <td>2.038361e+07</td>
      <td>1.568960e+07</td>
      <td>7.266485e+06</td>
      <td>2.653846</td>
      <td>1.237179</td>
      <td>0.275296</td>
      <td>15.884615</td>
    </tr>
    <tr>
      <th>주방용품</th>
      <td>1915.781250</td>
      <td>0.437500</td>
      <td>2.662433e+07</td>
      <td>8.727059e+06</td>
      <td>8.031344e+05</td>
      <td>3.375000</td>
      <td>1.810112</td>
      <td>0.309244</td>
      <td>18.218750</td>
    </tr>
    <tr>
      <th>차/커피</th>
      <td>1720.204545</td>
      <td>0.409091</td>
      <td>3.490728e+07</td>
      <td>9.481140e+06</td>
      <td>1.415527e+06</td>
      <td>11.272727</td>
      <td>3.186118</td>
      <td>0.202655</td>
      <td>29.522727</td>
    </tr>
    <tr>
      <th>축산가공</th>
      <td>1549.542857</td>
      <td>0.457143</td>
      <td>2.919021e+07</td>
      <td>9.174922e+06</td>
      <td>1.863726e+06</td>
      <td>13.057143</td>
      <td>4.447743</td>
      <td>0.276677</td>
      <td>14.542857</td>
    </tr>
    <tr>
      <th>침구/수예</th>
      <td>1259.000000</td>
      <td>0.000000</td>
      <td>1.042408e+08</td>
      <td>2.183750e+07</td>
      <td>1.587622e+07</td>
      <td>10.500000</td>
      <td>1.537500</td>
      <td>0.455357</td>
      <td>24.750000</td>
    </tr>
    <tr>
      <th>캐주얼</th>
      <td>1809.099010</td>
      <td>0.405941</td>
      <td>1.051814e+08</td>
      <td>2.143648e+07</td>
      <td>9.669807e+06</td>
      <td>18.079208</td>
      <td>2.402064</td>
      <td>0.398104</td>
      <td>17.950495</td>
    </tr>
    <tr>
      <th>커리어</th>
      <td>1569.444444</td>
      <td>0.333333</td>
      <td>4.605226e+07</td>
      <td>2.220560e+07</td>
      <td>1.087753e+07</td>
      <td>7.666667</td>
      <td>1.657407</td>
      <td>0.220685</td>
      <td>20.777778</td>
    </tr>
    <tr>
      <th>통신/컴퓨터</th>
      <td>1996.333333</td>
      <td>0.666667</td>
      <td>1.562293e+07</td>
      <td>1.518093e+07</td>
      <td>0.000000e+00</td>
      <td>1.666667</td>
      <td>1.166667</td>
      <td>0.388889</td>
      <td>20.333333</td>
    </tr>
    <tr>
      <th>트래디셔널</th>
      <td>1787.000000</td>
      <td>0.478261</td>
      <td>1.083664e+08</td>
      <td>1.598219e+07</td>
      <td>1.706661e+06</td>
      <td>9.565217</td>
      <td>1.706542</td>
      <td>0.442625</td>
      <td>20.130435</td>
    </tr>
    <tr>
      <th>피혁잡화</th>
      <td>1664.100000</td>
      <td>0.475000</td>
      <td>1.939674e+07</td>
      <td>8.885662e+06</td>
      <td>6.713850e+05</td>
      <td>3.300000</td>
      <td>1.554037</td>
      <td>0.410539</td>
      <td>18.925000</td>
    </tr>
    <tr>
      <th>화장품</th>
      <td>1747.378788</td>
      <td>0.257576</td>
      <td>8.716193e+07</td>
      <td>1.629997e+07</td>
      <td>4.163192e+06</td>
      <td>13.515152</td>
      <td>1.799917</td>
      <td>0.276335</td>
      <td>24.250000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;총구매액&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    3.500000e+03
mean     9.191925e+07
std      1.635065e+08
min     -5.242152e+07
25%      4.747050e+06
50%      2.822270e+07
75%      1.065079e+08
max      2.323180e+09
Name: 총구매액, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;강남점&#39;, &#39;잠실점&#39;, &#39;관악점&#39;, &#39;광주점&#39;, &#39;본  점&#39;, &#39;일산점&#39;, &#39;대전점&#39;, &#39;부산본점&#39;, &#39;분당점&#39;,
       &#39;영등포점&#39;, &#39;미아점&#39;, &#39;청량리점&#39;, &#39;안양점&#39;, &#39;부평점&#39;, &#39;동래점&#39;, &#39;포항점&#39;, &#39;노원점&#39;, &#39;창원점&#39;,
       &#39;센텀시티점&#39;, &#39;인천점&#39;, &#39;대구점&#39;, &#39;전주점&#39;, &#39;울산점&#39;, &#39;상인점&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;기타&#39;, &#39;스포츠&#39;, &#39;남성 캐주얼&#39;, &#39;보석&#39;, &#39;디자이너&#39;, &#39;시티웨어&#39;, &#39;명품&#39;, &#39;농산물&#39;, &#39;화장품&#39;,
       &#39;골프&#39;, &#39;구두&#39;, &#39;가공식품&#39;, &#39;수산품&#39;, &#39;아동&#39;, &#39;차/커피&#39;, &#39;캐주얼&#39;, &#39;섬유잡화&#39;, &#39;육류&#39;,
       &#39;축산가공&#39;, &#39;젓갈/반찬&#39;, &#39;액세서리&#39;, &#39;피혁잡화&#39;, &#39;일용잡화&#39;, &#39;주방가전&#39;, &#39;주방용품&#39;, &#39;건강식품&#39;,
       &#39;가구&#39;, &#39;주류&#39;, &#39;모피/피혁&#39;, &#39;남성 트랜디&#39;, &#39;셔츠&#39;, &#39;남성정장&#39;, &#39;생활잡화&#39;, &#39;트래디셔널&#39;,
       &#39;란제리/내의&#39;, &#39;커리어&#39;, &#39;침구/수예&#39;, &#39;대형가전&#39;, &#39;통신/컴퓨터&#39;, &#39;식기&#39;, &#39;소형가전&#39;, &#39;악기&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf</span> <span class="o">=</span> <span class="n">trainDf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">,</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()[</span><span class="s1">&#39;cust_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>


<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cdf</span><span class="p">[</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">[</span><span class="n">cdf</span><span class="p">[</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">v</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>주구매지점</th>
      <th>주구매상품</th>
      <th>cust_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>강남점</td>
      <td>가공식품</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>강남점</td>
      <td>건강식품</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>강남점</td>
      <td>구두</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>강남점</td>
      <td>기타</td>
      <td>31</td>
    </tr>
    <tr>
      <th>4</th>
      <td>강남점</td>
      <td>남성 캐주얼</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>437</th>
      <td>포항점</td>
      <td>기타</td>
      <td>4</td>
    </tr>
    <tr>
      <th>438</th>
      <td>포항점</td>
      <td>모피/피혁</td>
      <td>1</td>
    </tr>
    <tr>
      <th>439</th>
      <td>포항점</td>
      <td>시티웨어</td>
      <td>2</td>
    </tr>
    <tr>
      <th>440</th>
      <td>포항점</td>
      <td>일용잡화</td>
      <td>1</td>
    </tr>
    <tr>
      <th>441</th>
      <td>포항점</td>
      <td>화장품</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>442 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="o">.</span><span class="n">drop</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>gender</th>
      <th>총구매액</th>
      <th>최대구매액</th>
      <th>환불금액</th>
      <th>주구매상품</th>
      <th>주구매지점</th>
      <th>내점일수</th>
      <th>내점당구매건수</th>
      <th>주말방문비율</th>
      <th>구매주기</th>
      <th>방문당평균구매금액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>68282840</td>
      <td>11264000</td>
      <td>6860000.0</td>
      <td>기타</td>
      <td>강남점</td>
      <td>19</td>
      <td>3.894737</td>
      <td>0.527027</td>
      <td>17</td>
      <td>1.399704e+07</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>2136000</td>
      <td>2136000</td>
      <td>300000.0</td>
      <td>스포츠</td>
      <td>잠실점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>1</td>
      <td>1.602000e+06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>3197000</td>
      <td>1639000</td>
      <td>0.0</td>
      <td>남성 캐주얼</td>
      <td>관악점</td>
      <td>2</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1</td>
      <td>3.197000e+06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1</td>
      <td>16077620</td>
      <td>4935000</td>
      <td>0.0</td>
      <td>기타</td>
      <td>광주점</td>
      <td>18</td>
      <td>2.444444</td>
      <td>0.318182</td>
      <td>16</td>
      <td>2.183380e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>29050000</td>
      <td>24000000</td>
      <td>0.0</td>
      <td>보석</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.500000</td>
      <td>0.000000</td>
      <td>85</td>
      <td>2.178750e+07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3495</th>
      <td>3495</td>
      <td>1</td>
      <td>3175200</td>
      <td>3042900</td>
      <td>0.0</td>
      <td>골프</td>
      <td>본  점</td>
      <td>1</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>0</td>
      <td>6.350400e+06</td>
    </tr>
    <tr>
      <th>3496</th>
      <td>3496</td>
      <td>1</td>
      <td>29628600</td>
      <td>7200000</td>
      <td>6049600.0</td>
      <td>시티웨어</td>
      <td>부산본점</td>
      <td>8</td>
      <td>1.625000</td>
      <td>0.461538</td>
      <td>40</td>
      <td>6.018309e+06</td>
    </tr>
    <tr>
      <th>3497</th>
      <td>3497</td>
      <td>0</td>
      <td>75000</td>
      <td>75000</td>
      <td>0.0</td>
      <td>주방용품</td>
      <td>창원점</td>
      <td>1</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>7.500000e+04</td>
    </tr>
    <tr>
      <th>3498</th>
      <td>3498</td>
      <td>0</td>
      <td>1875000</td>
      <td>1000000</td>
      <td>0.0</td>
      <td>화장품</td>
      <td>본  점</td>
      <td>2</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>39</td>
      <td>9.375000e+05</td>
    </tr>
    <tr>
      <th>3499</th>
      <td>3499</td>
      <td>0</td>
      <td>263101550</td>
      <td>34632000</td>
      <td>5973000.0</td>
      <td>기타</td>
      <td>본  점</td>
      <td>38</td>
      <td>2.421053</td>
      <td>0.467391</td>
      <td>8</td>
      <td>1.676270e+07</td>
    </tr>
  </tbody>
</table>
<p>3500 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;방문당평균구매금액&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;총구매액&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;내점일수&#39;</span><span class="p">]</span> <span class="o">*</span><span class="n">trainDf</span><span class="p">[</span><span class="s1">&#39;내점당구매건수&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">trainDf</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;cust_id&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;방문당평균구매금액&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">trainDf</span><span class="o">.</span><span class="n">gender</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_label</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;주구매상품&#39;</span><span class="p">,</span><span class="s1">&#39;주구매지점&#39;</span><span class="p">]:</span>
    <span class="n">x_label</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_label</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_dum</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">feature_name_lst</span><span class="o">=</span> <span class="n">x_dum</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">x_dum</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_dum</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">x_dum</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span><span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">imblearn.over_sampling</span> <span class="kn">import</span> <span class="n">SMOTE</span>

<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1">#X_train_over,y_train_over = smote.fit_sample(X_train,y_train)</span>
<span class="n">X_train_over</span><span class="p">,</span><span class="n">y_train_over</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_over</span><span class="p">,</span> <span class="n">y_train_over</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RandomForestClassifier(max_depth=2, random_state=0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">report</span> <span class="o">=</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;class 0&#39;</span><span class="p">,</span> <span class="s1">&#39;class 1&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

     class 0       0.74      0.55      0.63       655
     class 1       0.48      0.68      0.56       395

    accuracy                           0.60      1050
   macro avg       0.61      0.61      0.60      1050
weighted avg       0.64      0.60      0.60      1050
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span> <span class="p">,</span><span class="n">roc_curve</span>

<span class="n">lr_probs</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">lr_auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">lr_probs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">lr_auc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.656857667407479
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">randint</span> <span class="k">as</span> <span class="n">sp_randint</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">uniform</span> <span class="k">as</span> <span class="n">sp_uniform</span>
<span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span><span class="p">,</span> <span class="n">GridSearchCV</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model_kaggle</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">feature_name_lst</span><span class="p">,</span><span class="n">seed1</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;&quot;</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;one_que&#39;</span>

    <span class="n">random_seed_change</span> <span class="o">=</span><span class="mi">314</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="n">label</span> <span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed_change</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

    
<span class="c1">#     from sklearn.preprocessing import PolynomialFeatures, PowerTransformer</span>

<span class="c1">#     pt = PowerTransformer()</span>
<span class="c1">#     pt.fit(X_train)                       ## Fit the PT on training data</span>
<span class="c1">#     X_train = pt.transform(X_train)    ## Then apply on all data</span>
<span class="c1">#     X_test = pt.transform(X_test)</span>



    <span class="k">def</span> <span class="nf">learning_rate_010_decay_power_099</span><span class="p">(</span><span class="n">current_iter</span><span class="p">):</span>
        <span class="n">base_learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="n">base_learning_rate</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="n">current_iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lr</span> <span class="k">if</span> <span class="n">lr</span> <span class="o">&gt;</span> <span class="mf">1e-4</span> <span class="k">else</span> <span class="mf">1e-4</span>

    <span class="k">def</span> <span class="nf">learning_rate_010_decay_power_0995</span><span class="p">(</span><span class="n">current_iter</span><span class="p">):</span>
        <span class="n">base_learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="n">base_learning_rate</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">.</span><span class="mi">995</span><span class="p">,</span> <span class="n">current_iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lr</span> <span class="k">if</span> <span class="n">lr</span> <span class="o">&gt;</span> <span class="mf">1e-4</span> <span class="k">else</span> <span class="mf">1e-4</span>

    <span class="k">def</span> <span class="nf">learning_rate_005_decay_power_099</span><span class="p">(</span><span class="n">current_iter</span><span class="p">):</span>
        <span class="n">base_learning_rate</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="n">base_learning_rate</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">.</span><span class="mi">99</span><span class="p">,</span> <span class="n">current_iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lr</span> <span class="k">if</span> <span class="n">lr</span> <span class="o">&gt;</span> <span class="mf">1e-3</span> <span class="k">else</span> <span class="mf">1e-3</span>

    <span class="k">def</span> <span class="nf">learning_rate_010_decay_power_0996</span><span class="p">(</span><span class="n">current_iter</span><span class="p">):</span>
        <span class="n">base_learning_rate</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="n">base_learning_rate</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">.</span><span class="mi">996</span><span class="p">,</span> <span class="n">current_iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lr</span> <span class="k">if</span> <span class="n">lr</span> <span class="o">&gt;</span> <span class="mf">1e-4</span> <span class="k">else</span> <span class="mf">1e-4</span>

    
    <span class="n">fit_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;early_stopping_rounds&quot;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span> 
                <span class="s2">&quot;eval_metric&quot;</span> <span class="p">:</span> <span class="s1">&#39;auc&#39;</span><span class="p">,</span> 
                <span class="s2">&quot;eval_set&quot;</span> <span class="p">:</span> <span class="p">[(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)],</span>
                <span class="s1">&#39;eval_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">],</span>
                <span class="s1">&#39;callbacks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">lgb</span><span class="o">.</span><span class="n">reset_parameter</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate_010_decay_power_0996</span><span class="p">)],</span>
                <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;categorical_feature&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">}</span>




    <span class="n">param_test</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_leaves&#39;</span><span class="p">:</span> <span class="n">sp_randint</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> 
                 <span class="s1">&#39;min_child_samples&#39;</span><span class="p">:</span> <span class="n">sp_randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> 
                 <span class="s1">&#39;min_child_weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1e1</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">],</span>
                 <span class="s1">&#39;subsample&#39;</span><span class="p">:</span> <span class="n">sp_uniform</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span> 
                 <span class="s1">&#39;colsample_bytree&#39;</span><span class="p">:</span> <span class="n">sp_uniform</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.6</span><span class="p">),</span>
                 <span class="s1">&#39;reg_alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                 <span class="s1">&#39;reg_lambda&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]}</span>


    <span class="n">n_HP_points_to_test</span> <span class="o">=</span> <span class="mi">100</span>


    <span class="c1">#n_estimators is set to a &quot;large value&quot;. The actual number of trees build will depend on early stopping and 5000 define only the absolute maximum</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed1</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span>
        <span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span> <span class="n">param_distributions</span><span class="o">=</span><span class="n">param_test</span><span class="p">,</span> 
        <span class="n">n_iter</span><span class="o">=</span><span class="n">n_HP_points_to_test</span><span class="p">,</span>
        <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">,</span>
        <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">refit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="n">random_seed_change</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



    <span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best score reached: </span><span class="si">{}</span><span class="s1"> with params: </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">))</span>

    <span class="n">opt_parameters</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span>
    <span class="n">clf_final</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">LGBMClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">clf</span><span class="o">.</span><span class="n">get_params</span><span class="p">())</span>
    <span class="n">clf_final</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">opt_parameters</span><span class="p">)</span>

    <span class="c1">#Train the final model with learning rate decay</span>
    <span class="n">fit_params_final</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;early_stopping_rounds&quot;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> 
                <span class="s2">&quot;eval_metric&quot;</span> <span class="p">:</span> <span class="s1">&#39;auc&#39;</span><span class="p">,</span> 
                <span class="s2">&quot;eval_set&quot;</span> <span class="p">:</span> <span class="p">[(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">)],</span>
                <span class="s1">&#39;eval_names&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">],</span>
                <span class="s1">&#39;callbacks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">lgb</span><span class="o">.</span><span class="n">reset_parameter</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate_010_decay_power_0995</span><span class="p">)],</span>
                <span class="s1">&#39;verbose&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                <span class="s1">&#39;categorical_feature&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">}</span>
    
    
    
    <span class="n">clf_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params_final</span><span class="p">)</span> <span class="c1">#,feature_name =feature_name_lst)</span>

    <span class="k">return</span> <span class="n">clf_final</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label</span><span class="o">=</span> <span class="n">y_train_over</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_over</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3058, 73)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="o">=</span><span class="s1">&#39;&#39;</span>

<span class="n">models33</span> <span class="o">=</span><span class="n">model_kaggle</span><span class="p">(</span><span class="n">X_train_over</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="mi">314</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting 3 folds for each of 100 candidates, totalling 300 fits
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[34]	valid&#39;s auc: 0.643935
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.638312
[200]	valid&#39;s auc: 0.64071
Early stopping, best iteration is:
[266]	valid&#39;s auc: 0.642814
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[63]	valid&#39;s auc: 0.638318
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.643193
Early stopping, best iteration is:
[156]	valid&#39;s auc: 0.645574
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.644464
[200]	valid&#39;s auc: 0.647641
Early stopping, best iteration is:
[181]	valid&#39;s auc: 0.648148
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.643139
Early stopping, best iteration is:
[100]	valid&#39;s auc: 0.643139
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.581699
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.655789
[200]	valid&#39;s auc: 0.663089
Early stopping, best iteration is:
[188]	valid&#39;s auc: 0.663975
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[56]	valid&#39;s auc: 0.658294
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.642125
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[41]	valid&#39;s auc: 0.643134
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.642509
Early stopping, best iteration is:
[165]	valid&#39;s auc: 0.644693
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[36]	valid&#39;s auc: 0.643802
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.639161
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[14]	valid&#39;s auc: 0.649665
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[19]	valid&#39;s auc: 0.647118
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.645339
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.659511
Early stopping, best iteration is:
[89]	valid&#39;s auc: 0.661113
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.637442
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.665545
[200]	valid&#39;s auc: 0.669742
Early stopping, best iteration is:
[170]	valid&#39;s auc: 0.671718
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.667089
[200]	valid&#39;s auc: 0.6734
Early stopping, best iteration is:
[238]	valid&#39;s auc: 0.677053
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[68]	valid&#39;s auc: 0.651897
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[25]	valid&#39;s auc: 0.64189
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.654834
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[25]	valid&#39;s auc: 0.646231
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[36]	valid&#39;s auc: 0.64048
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.626538
[200]	valid&#39;s auc: 0.631205
Early stopping, best iteration is:
[196]	valid&#39;s auc: 0.631728
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[28]	valid&#39;s auc: 0.643417
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[30]	valid&#39;s auc: 0.641719
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[9]	valid&#39;s auc: 0.652212
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[20]	valid&#39;s auc: 0.644287
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[8]	valid&#39;s auc: 0.640384
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[24]	valid&#39;s auc: 0.639978
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[17]	valid&#39;s auc: 0.638093
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[41]	valid&#39;s auc: 0.640101
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.630025
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[31]	valid&#39;s auc: 0.641986
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.653387
Early stopping, best iteration is:
[158]	valid&#39;s auc: 0.660595
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.651918
[200]	valid&#39;s auc: 0.65941
[300]	valid&#39;s auc: 0.661834
[400]	valid&#39;s auc: 0.664536
[500]	valid&#39;s auc: 0.665679
Early stopping, best iteration is:
[529]	valid&#39;s auc: 0.665999
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.645398
Early stopping, best iteration is:
[72]	valid&#39;s auc: 0.645446
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.615415
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.60103
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[35]	valid&#39;s auc: 0.628001
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.659533
Early stopping, best iteration is:
[132]	valid&#39;s auc: 0.662918
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[32]	valid&#39;s auc: 0.662149
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[62]	valid&#39;s auc: 0.646717
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.581699
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.64323
Early stopping, best iteration is:
[80]	valid&#39;s auc: 0.643999
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[45]	valid&#39;s auc: 0.645355
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.645169
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.581699
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.653216
[200]	valid&#39;s auc: 0.659543
[300]	valid&#39;s auc: 0.661738
[400]	valid&#39;s auc: 0.663772
[500]	valid&#39;s auc: 0.666053
[600]	valid&#39;s auc: 0.667024
Early stopping, best iteration is:
[663]	valid&#39;s auc: 0.667452
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.650359
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[57]	valid&#39;s auc: 0.644576
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[25]	valid&#39;s auc: 0.645975
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.65596
Early stopping, best iteration is:
[86]	valid&#39;s auc: 0.65745
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.641361
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.660713
Early stopping, best iteration is:
[137]	valid&#39;s auc: 0.664622
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.671553
Early stopping, best iteration is:
[99]	valid&#39;s auc: 0.671627
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.646989
Early stopping, best iteration is:
[90]	valid&#39;s auc: 0.648004
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.651966
[200]	valid&#39;s auc: 0.657311
Early stopping, best iteration is:
[268]	valid&#39;s auc: 0.659415
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.654364
[200]	valid&#39;s auc: 0.661866
[300]	valid&#39;s auc: 0.664007
Early stopping, best iteration is:
[338]	valid&#39;s auc: 0.664937
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.6459
Early stopping, best iteration is:
[123]	valid&#39;s auc: 0.647342
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[8]	valid&#39;s auc: 0.649948
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.647705
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[52]	valid&#39;s auc: 0.645638
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.624012
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[8]	valid&#39;s auc: 0.63372
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[39]	valid&#39;s auc: 0.636742
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.581699
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.643711
Early stopping, best iteration is:
[138]	valid&#39;s auc: 0.645809
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[64]	valid&#39;s auc: 0.647411
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[16]	valid&#39;s auc: 0.640603
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[21]	valid&#39;s auc: 0.641602
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.648137
[200]	valid&#39;s auc: 0.653087
[300]	valid&#39;s auc: 0.654503
Early stopping, best iteration is:
[331]	valid&#39;s auc: 0.655004
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[23]	valid&#39;s auc: 0.642338
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[13]	valid&#39;s auc: 0.624802
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[7]	valid&#39;s auc: 0.627702
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[48]	valid&#39;s auc: 0.636513
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.644485
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.640854
Early stopping, best iteration is:
[114]	valid&#39;s auc: 0.641714
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[32]	valid&#39;s auc: 0.647892
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.657584
[200]	valid&#39;s auc: 0.664066
Early stopping, best iteration is:
[198]	valid&#39;s auc: 0.664931
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.663954
[200]	valid&#39;s auc: 0.672006
Early stopping, best iteration is:
[214]	valid&#39;s auc: 0.672904
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.648506
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.637084
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[28]	valid&#39;s auc: 0.639759
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[37]	valid&#39;s auc: 0.639236
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[48]	valid&#39;s auc: 0.642087
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[31]	valid&#39;s auc: 0.639119
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[20]	valid&#39;s auc: 0.643161
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.581699
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.646098
[200]	valid&#39;s auc: 0.65156
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[300]	valid&#39;s auc: 0.654844
[400]	valid&#39;s auc: 0.656622
[500]	valid&#39;s auc: 0.657989
[600]	valid&#39;s auc: 0.658887
Early stopping, best iteration is:
[579]	valid&#39;s auc: 0.659186
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[47]	valid&#39;s auc: 0.650054
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[15]	valid&#39;s auc: 0.639017
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.635268
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.628626
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[13]	valid&#39;s auc: 0.63513
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[13]	valid&#39;s auc: 0.62476
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[8]	valid&#39;s auc: 0.632235
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.636833
Early stopping, best iteration is:
[105]	valid&#39;s auc: 0.637121
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.638035
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.627739
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[21]	valid&#39;s auc: 0.643337
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.640592
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[14]	valid&#39;s auc: 0.644624
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.642669
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.601622
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.599038
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[34]	valid&#39;s auc: 0.629587
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.634948
[200]	valid&#39;s auc: 0.637276
[300]	valid&#39;s auc: 0.64056
Early stopping, best iteration is:
[288]	valid&#39;s auc: 0.640758
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[22]	valid&#39;s auc: 0.628578
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.63671
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[17]	valid&#39;s auc: 0.601622
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.60103
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[66]	valid&#39;s auc: 0.632999
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.638478
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[28]	valid&#39;s auc: 0.639786
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.643834
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[8]	valid&#39;s auc: 0.637997
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[20]	valid&#39;s auc: 0.638697
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.637041
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[56]	valid&#39;s auc: 0.649003
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[7]	valid&#39;s auc: 0.651699
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[4]	valid&#39;s auc: 0.643065
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[13]	valid&#39;s auc: 0.634008
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[30]	valid&#39;s auc: 0.633079
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.638563
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[22]	valid&#39;s auc: 0.643481
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.641164
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[22]	valid&#39;s auc: 0.637463
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[16]	valid&#39;s auc: 0.638745
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[49]	valid&#39;s auc: 0.647849
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.646381
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[39]	valid&#39;s auc: 0.641505
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.626986
[200]	valid&#39;s auc: 0.630564
Early stopping, best iteration is:
[213]	valid&#39;s auc: 0.631835
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[15]	valid&#39;s auc: 0.644704
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[30]	valid&#39;s auc: 0.64064
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.649638
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.643609
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.658614
[200]	valid&#39;s auc: 0.66703
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Early stopping, best iteration is:
[207]	valid&#39;s auc: 0.667318
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.66059
[200]	valid&#39;s auc: 0.667206
[300]	valid&#39;s auc: 0.669641
Early stopping, best iteration is:
[274]	valid&#39;s auc: 0.670111
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[3]	valid&#39;s auc: 0.64873
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.615415
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.60103
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[61]	valid&#39;s auc: 0.631899
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.638734
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[30]	valid&#39;s auc: 0.631125
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.639973
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.636288
Early stopping, best iteration is:
[82]	valid&#39;s auc: 0.638456
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.632476
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[37]	valid&#39;s auc: 0.642739
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[3]	valid&#39;s auc: 0.645142
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.642333
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[19]	valid&#39;s auc: 0.644683
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.637703
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[23]	valid&#39;s auc: 0.642258
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.643033
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[57]	valid&#39;s auc: 0.617711
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[9]	valid&#39;s auc: 0.606813
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[36]	valid&#39;s auc: 0.637517
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.615415
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.60103
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.634751
Early stopping, best iteration is:
[75]	valid&#39;s auc: 0.634751
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.65674
Early stopping, best iteration is:
[79]	valid&#39;s auc: 0.658454
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.665471
[200]	valid&#39;s auc: 0.668749
Early stopping, best iteration is:
[180]	valid&#39;s auc: 0.670351
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.647401
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.615415
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.615351
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[63]	valid&#39;s auc: 0.638707
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.643348
Early stopping, best iteration is:
[75]	valid&#39;s auc: 0.64362
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[43]	valid&#39;s auc: 0.640939
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[38]	valid&#39;s auc: 0.644896
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.633074
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[40]	valid&#39;s auc: 0.630292
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[14]	valid&#39;s auc: 0.640154
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[20]	valid&#39;s auc: 0.612318
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[9]	valid&#39;s auc: 0.599182
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[34]	valid&#39;s auc: 0.627889
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[15]	valid&#39;s auc: 0.635172
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[44]	valid&#39;s auc: 0.627334
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.638184
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.639156
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[28]	valid&#39;s auc: 0.625246
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.644042
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[16]	valid&#39;s auc: 0.601622
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[48]	valid&#39;s auc: 0.599038
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[14]	valid&#39;s auc: 0.629592
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.640261
[200]	valid&#39;s auc: 0.64283
Early stopping, best iteration is:
[211]	valid&#39;s auc: 0.643075
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.638494
Early stopping, best iteration is:
[107]	valid&#39;s auc: 0.638996
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[25]	valid&#39;s auc: 0.643257
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.643962
Early stopping, best iteration is:
[113]	valid&#39;s auc: 0.644837
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[23]	valid&#39;s auc: 0.639989
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[18]	valid&#39;s auc: 0.64275
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.648287
[200]	valid&#39;s auc: 0.654428
[300]	valid&#39;s auc: 0.657445
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[400]	valid&#39;s auc: 0.659501
Early stopping, best iteration is:
[393]	valid&#39;s auc: 0.659682
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.651325
[200]	valid&#39;s auc: 0.657413
[300]	valid&#39;s auc: 0.661658
[400]	valid&#39;s auc: 0.664339
Early stopping, best iteration is:
[386]	valid&#39;s auc: 0.664723
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[22]	valid&#39;s auc: 0.638211
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.637063
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[46]	valid&#39;s auc: 0.625806
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[24]	valid&#39;s auc: 0.640945
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.654278
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[2]	valid&#39;s auc: 0.647806
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[7]	valid&#39;s auc: 0.651229
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.636027
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[29]	valid&#39;s auc: 0.630222
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[11]	valid&#39;s auc: 0.640405
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.655245
[200]	valid&#39;s auc: 0.661289
Early stopping, best iteration is:
[229]	valid&#39;s auc: 0.662737
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.663441
[200]	valid&#39;s auc: 0.670111
Early stopping, best iteration is:
[187]	valid&#39;s auc: 0.671243
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[10]	valid&#39;s auc: 0.635007
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[12]	valid&#39;s auc: 0.641116
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[17]	valid&#39;s auc: 0.649344
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[9]	valid&#39;s auc: 0.645227
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[21]	valid&#39;s auc: 0.645975
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[23]	valid&#39;s auc: 0.640464
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.639161
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[33]	valid&#39;s auc: 0.644389
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[26]	valid&#39;s auc: 0.637356
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[37]	valid&#39;s auc: 0.64425
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[1]	valid&#39;s auc: 0.5
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.642835
Early stopping, best iteration is:
[76]	valid&#39;s auc: 0.644336
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.658347
Early stopping, best iteration is:
[94]	valid&#39;s auc: 0.659784
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[27]	valid&#39;s auc: 0.640881
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[7]	valid&#39;s auc: 0.643716
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.628519
Early stopping, best iteration is:
[110]	valid&#39;s auc: 0.629784
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[19]	valid&#39;s auc: 0.643038
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[9]	valid&#39;s auc: 0.634772
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[23]	valid&#39;s auc: 0.633966
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[13]	valid&#39;s auc: 0.636956
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[56]	valid&#39;s auc: 0.640283
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.643535
[200]	valid&#39;s auc: 0.647694
[300]	valid&#39;s auc: 0.648864
[400]	valid&#39;s auc: 0.650348
Early stopping, best iteration is:
[424]	valid&#39;s auc: 0.650733
Training until validation scores don&#39;t improve for 30 rounds
Early stopping, best iteration is:
[16]	valid&#39;s auc: 0.640299
Training until validation scores don&#39;t improve for 30 rounds
[100]	valid&#39;s auc: 0.690632
Early stopping, best iteration is:
[95]	valid&#39;s auc: 0.69218
Best score reached: 0.7009944510214838 with params: {&#39;colsample_bytree&#39;: 0.55607546409401, &#39;min_child_samples&#39;: 103, &#39;min_child_weight&#39;: 10.0, &#39;num_leaves&#39;: 22, &#39;reg_alpha&#39;: 2, &#39;reg_lambda&#39;: 1, &#39;subsample&#39;: 0.8939112927620336} 
Training until validation scores don&#39;t improve for 100 rounds
[100]	valid&#39;s auc: 0.694909
[200]	valid&#39;s auc: 0.695993
[300]	valid&#39;s auc: 0.698973
[400]	valid&#39;s auc: 0.700553
[500]	valid&#39;s auc: 0.702022
[600]	valid&#39;s auc: 0.702481
[700]	valid&#39;s auc: 0.703132
[800]	valid&#39;s auc: 0.703293
[900]	valid&#39;s auc: 0.703442
[1000]	valid&#39;s auc: 0.703538
Early stopping, best iteration is:
[992]	valid&#39;s auc: 0.703549
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="n">name</span> <span class="o">=</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
<span class="n">mode</span> <span class="o">=</span><span class="s1">&#39;save&#39;</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">probabilities</span> <span class="o">=</span> <span class="n">models33</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">probabilities</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">model_name</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">probabilities</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/main_p2222_92_0.png" src="../../_images/main_p2222_92_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./dataset/03_dataq"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By DataManim<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-194339703-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>